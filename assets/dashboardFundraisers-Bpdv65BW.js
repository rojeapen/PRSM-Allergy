import{c as R,j as e,r as o,i as I,b as M,f as v,d as N,e as D,F as A,u as O,P as H}from"./auth-DGWyFIKM.js";import{H as $}from"./header-DtqvAvu1.js";R.createRoot(document.getElementById("root")).render(e.jsx(o.StrictMode,{children:e.jsx(B,{})}));class n{name;description;photoUrl;photoFile;photoId;link;id;isFeatured;constructor(l){this.name=l.name,this.description=l.description,this.photoUrl=l.photoUrl,this.photoFile=l.photoFile,this.photoId=l.photoId,this.link=l.link,this.id=l.id,this.isFeatured=l.isFeatured??!1}}function B(){const[c,l]=o.useState(null),[d,p]=o.useState([]),[w,m]=o.useState(!1),[f,F]=o.useState(!1),[r,g]=o.useState(new n({name:"",description:"",link:""})),[b,x]=o.useState(null),[i,h]=o.useState(null);o.useEffect(()=>{I(s=>{}),M().then(s=>{const a=s.fundraisers.map((t,u)=>(console.log("Loaded fundraiser:",t),new n({name:t.name,description:t.description,photoUrl:t.photo.url,link:t.link,photoId:t.photo.id,id:u.toString(),isFeatured:t.isFeatured})));console.log(a),p(a),l(s)})},[]);const k=()=>{!r.name.trim()||!r.description.trim()||!r.link.trim()||(p([...d,new n({...r})]),g(new n({name:"",description:"",link:""})),m(!0))},C=s=>{x(s),h(new n({...d[s]}))},j=(s,a)=>{i&&h(new n({...i,[s]:a}))},S=s=>{i&&h(new n({...i,photoFile:s}))},P=s=>{if(!i)return;const a=[...d];a[s]=new n({...i}),p(a),x(null),h(null),m(!0)},U=()=>{x(null),h(null)},E=s=>{p(d.filter((a,t)=>t!==s)),m(!0),b===s&&(x(null),h(null))},y=s=>{const a=d.map((t,u)=>u===s?new n({...t,isFeatured:!t.isFeatured}):t.isFeatured?new n({...t,isFeatured:!1}):t);p(a),m(!0)},L=async()=>{if(!c)return;F(!0);const s=[];for(const a of d){let t=new v({url:a.photoUrl||"",id:a.photoId||""});console.log("Processing fundraiser:",a),a.photoUrl&&a.photoFile&&await N(t),a.photoFile&&(t=await D(a.photoFile,`Fundraiser ${a.name}`)),s.push(new A({name:a.name,description:a.description,photo:new v({url:t.url,id:t.id}),link:a.link,isFeatured:a.isFeatured}))}for(const a of c.fundraisers)s.find(u=>u.name===a.name)||await N(a.photo);c.fundraisers=s,await O(c),m(!1),F(!1),l(H.fromMap(c.toMap()))};return e.jsxs(e.Fragment,{children:[e.jsx($,{isDashboardFundraisersPage:!0}),c?e.jsx(e.Fragment,{children:e.jsxs("section",{className:"dashboard-section light",children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h1",{children:"Fundraisers"}),e.jsx("p",{children:"Manage fundraising campaigns shown on the main website."})]}),e.jsxs("div",{className:"fundraisers-dashboard-content",children:[e.jsxs("div",{className:"fundraisers-dashboard-list",children:[d.length===0&&e.jsx("div",{children:"No fundraisers yet."}),d.map((s,a)=>e.jsx("div",{className:"fundraisers-dashboard-item",children:b===a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"fundraiser-form-group",children:[e.jsx("label",{children:"Name:"}),e.jsx("input",{type:"text",className:"input-light",value:i?.name||"",onChange:t=>j("name",t.target.value)})]}),e.jsxs("div",{className:"fundraiser-form-group",children:[e.jsx("label",{children:"Description:"}),e.jsx("textarea",{className:"input-light",value:i?.description||"",onChange:t=>j("description",t.target.value)})]}),e.jsxs("div",{className:"fundraiser-form-group",children:[e.jsx("label",{children:"Donation Link:"}),e.jsx("input",{type:"text",className:"input-light",value:i?.link||"",onChange:t=>j("link",t.target.value)})]}),e.jsxs("div",{className:"fundraiser-form-group",children:[e.jsx("label",{children:"Photo:"}),e.jsx("input",{type:"file",className:"input-light",onChange:t=>{t.target.files&&t.target.files[0]&&S(t.target.files[0])}}),i?.photoUrl&&!i?.photoFile&&e.jsx("img",{src:i.photoUrl,alt:"Preview",className:"fundraisers-dashboard-thumbnail"}),i?.photoFile&&e.jsx("img",{src:URL.createObjectURL(i.photoFile),alt:"Preview",className:"fundraisers-dashboard-thumbnail"})]}),e.jsxs("div",{className:"fundraisers-dashboard-actions",children:[e.jsx("button",{className:"btn-primary",onClick:()=>P(a),children:"Save"}),e.jsx("button",{className:"btn-danger",onClick:U,children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"fundraisers-dashboard-item-preview",children:[e.jsx("img",{src:s.photoFile!=null?URL.createObjectURL(s.photoFile):s.photoUrl?s.photoUrl:"",alt:s.name,className:"fundraisers-dashboard-thumbnail"}),e.jsxs("div",{className:"fundraisers-dashboard-item-info",children:[e.jsx("h4",{children:s.name}),e.jsx("p",{children:s.description}),e.jsx("p",{className:"fundraisers-dashboard-item-link",children:s.link})]})]}),e.jsxs("div",{className:"fundraisers-dashboard-actions",children:[e.jsx("button",{className:`btn-star ${s.isFeatured?"featured":""}`,onClick:()=>y(a),title:"Mark as featured",children:s.isFeatured?"★":"☆"}),e.jsx("button",{className:"btn-primary",onClick:()=>C(a),children:"Edit"}),e.jsx("button",{className:"btn-danger",onClick:()=>E(a),children:"Delete"})]})]})},a))]}),e.jsxs("div",{className:"fundraisers-dashboard-add",children:[e.jsx("h3",{style:{margin:"0 0 1rem 0"},children:"Add New Fundraiser"}),e.jsxs("div",{className:"fundraiser-form-group",children:[e.jsx("label",{children:"Name:"}),e.jsx("input",{type:"text",className:"input-light",placeholder:"Fundraiser name",value:r.name,onChange:s=>g(new n({...r,name:s.target.value}))})]}),e.jsxs("div",{className:"fundraiser-form-group",children:[e.jsx("label",{children:"Description:"}),e.jsx("textarea",{className:"input-light",placeholder:"Fundraiser description",value:r.description,onChange:s=>g(new n({...r,description:s.target.value}))})]}),e.jsxs("div",{className:"fundraiser-form-group",children:[e.jsx("label",{children:"Donation Link:"}),e.jsx("input",{type:"text",className:"input-light",placeholder:"https://...",value:r.link,onChange:s=>g(new n({...r,link:s.target.value}))})]}),e.jsxs("div",{className:"fundraiser-form-group",children:[e.jsx("label",{children:"Photo:"}),e.jsx("input",{type:"file",className:"input-light",onChange:s=>{s.target.files&&s.target.files[0]&&g(new n({...r,photoFile:s.target.files[0]}))}}),r.photoFile&&e.jsx("img",{src:URL.createObjectURL(r.photoFile),alt:"Preview",className:"fundraisers-dashboard-thumbnail"})]}),e.jsx("button",{className:"btn-primary",onClick:k,children:"Add Fundraiser"})]}),w&&!f&&e.jsx("button",{className:"btn-primary",onClick:L,children:"Save Changes"}),f&&e.jsx("div",{className:"loader"})]})]})}):e.jsx("div",{className:"loader-container",children:e.jsx("div",{className:"loader"})})]})}
