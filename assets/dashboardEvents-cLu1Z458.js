import{c as R,j as e,r,n as D,o as I,E as b,x as M,v as k,w as T,t as O,P as A}from"./auth-DGGTltaB.js";import{H}from"./header-DLX5zauo.js";R.createRoot(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(B,{})}));class o{title;description;date;time;location;photoUrl;photoFile;photoId;id;capacity;attendees;constructor(l){this.title=l.title,this.description=l.description,this.date=l.date,this.time=l.time,this.location=l.location,this.photoUrl=l.photoUrl,this.photoFile=l.photoFile,this.photoId=l.photoId,this.id=l.id,this.capacity=l.capacity,this.attendees=l.attendees}}function B(){const[d,l]=r.useState(null),[h,v]=r.useState([]),[E,g]=r.useState(!1),[j,N]=r.useState(!1),[a,p]=r.useState(new o({title:"",description:"",date:"",time:"",location:""})),[f,x]=r.useState(null),[n,m]=r.useState(null);r.useEffect(()=>{D(t=>{}),I().then(t=>{const s=t.events.map((i,c)=>new o({title:i.title,description:i.description,date:i.date,time:i.time,location:i.location,photoUrl:i.photoUrl,id:c.toString()}));v(s),l(t)})},[]);const w=()=>{!a.title.trim()||!a.description.trim()||!a.date.trim()||!a.time.trim()||!a.location.trim()||(v([...h,new o({...a})]),p(new o({title:"",description:"",date:"",time:"",location:""})),g(!0))},y=t=>{x(t),m(new o({...h[t]}))},u=(t,s)=>{n&&m(new o({...n,[t]:s}))},C=t=>{n&&m(new o({...n,photoFile:t}))},F=t=>{if(!n)return;const s=[...h];s[t]=new o({...n}),v(s),x(null),m(null),g(!0)},U=()=>{x(null),m(null)},S=t=>{v(h.filter((s,i)=>i!==t)),g(!0),f===t&&(x(null),m(null))},P=async()=>{if(!d)return;N(!0);const t=[];for(const s of h){let i=new M({url:s.photoUrl||"",id:s.photoId||""});s.photoUrl&&s.photoFile&&await k(i),s.photoFile&&(i=await T(s.photoFile,`Event ${s.title}`));const L=new Date(s.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});t.push(new b({title:s.title,description:s.description,date:s.date,displayDate:L,time:s.time,location:s.location,photoUrl:i.url}))}for(const s of d.events)if(!t.find(c=>c.title===s.title))try{const c=s.photoUrl}catch(c){console.error("Error deleting event photo:",c)}d.events=t,await O(d),g(!1),N(!1),l(A.fromMap(d.toMap()))};return e.jsxs(e.Fragment,{children:[e.jsx(H,{isDashboardEventsPage:!0}),d?e.jsx(e.Fragment,{children:e.jsxs("section",{className:"dashboard-section light",children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h1",{children:"Events"}),e.jsx("p",{children:"Manage events shown on the main website."})]}),e.jsxs("div",{className:"events-dashboard-content",children:[e.jsxs("div",{className:"events-dashboard-list",children:[h.length===0&&e.jsx("div",{children:"No events yet."}),h.map((t,s)=>e.jsx("div",{className:"events-dashboard-item",children:f===s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"event-form-group",children:[e.jsx("label",{children:"Title:"}),e.jsx("input",{type:"text",className:"input-light",value:n?.title||"",onChange:i=>u("title",i.target.value)})]}),e.jsxs("div",{className:"event-form-group",children:[e.jsx("label",{children:"Description:"}),e.jsx("textarea",{className:"input-light",value:n?.description||"",onChange:i=>u("description",i.target.value)})]}),e.jsxs("div",{className:"event-form-group",children:[e.jsx("label",{children:"Date:"}),e.jsx("input",{type:"date",className:"input-light",value:n?.date||"",onChange:i=>u("date",i.target.value)})]}),e.jsxs("div",{className:"event-form-group",children:[e.jsx("label",{children:"Time:"}),e.jsx("input",{type:"time",className:"input-light",value:n?.time||"",onChange:i=>u("time",i.target.value)})]}),e.jsxs("div",{className:"event-form-group",children:[e.jsx("label",{children:"Location:"}),e.jsx("input",{type:"text",className:"input-light",value:n?.location||"",onChange:i=>u("location",i.target.value)})]}),e.jsxs("div",{className:"event-form-group",children:[e.jsx("label",{children:"Photo:"}),e.jsx("input",{type:"file",className:"input-light",onChange:i=>{i.target.files&&i.target.files[0]&&C(i.target.files[0])}}),n?.photoUrl&&!n?.photoFile&&e.jsx("img",{src:n.photoUrl,alt:"Preview",className:"events-dashboard-thumbnail"}),n?.photoFile&&e.jsx("img",{src:URL.createObjectURL(n.photoFile),alt:"Preview",className:"events-dashboard-thumbnail"})]}),e.jsxs("div",{className:"events-dashboard-actions",children:[e.jsx("button",{className:"btn-primary",onClick:()=>F(s),children:"Save"}),e.jsx("button",{className:"btn-danger",onClick:U,children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"events-dashboard-item-preview",children:[e.jsx("img",{src:t.photoFile!=null?URL.createObjectURL(t.photoFile):t.photoUrl?t.photoUrl:"",alt:t.title,className:"events-dashboard-thumbnail"}),e.jsxs("div",{className:"events-dashboard-item-info",children:[e.jsx("h4",{children:t.title}),e.jsxs("p",{className:"event-date-time",children:["ðŸ“… ",t.date," â€¢ ðŸ• ",new b({title:"",description:"",date:"",displayDate:"",time:t.time,location:"",photoUrl:""}).getFormattedTime()]}),e.jsxs("p",{className:"event-location",children:["ðŸ“ ",t.location]}),e.jsx("p",{children:t.description})]})]}),e.jsxs("div",{className:"events-dashboard-actions",children:[e.jsx("button",{className:"btn-primary",onClick:()=>y(s),children:"Edit"}),e.jsx("button",{className:"btn-danger",onClick:()=>S(s),children:"Delete"})]})]})},s))]}),e.jsxs("div",{className:"events-dashboard-add",children:[e.jsx("h3",{style:{margin:"0 0 1rem 0"},children:"Add New Event"}),e.jsxs("div",{className:"event-form-group",children:[e.jsx("label",{children:"Title:"}),e.jsx("input",{type:"text",className:"input-light",placeholder:"Event title",value:a.title,onChange:t=>p(new o({...a,title:t.target.value}))})]}),e.jsxs("div",{className:"event-form-group",children:[e.jsx("label",{children:"Description:"}),e.jsx("textarea",{className:"input-light",placeholder:"Event description",value:a.description,onChange:t=>p(new o({...a,description:t.target.value}))})]}),e.jsxs("div",{className:"event-form-group",children:[e.jsx("label",{children:"Date:"}),e.jsx("input",{type:"date",className:"input-light",value:a.date,onChange:t=>p(new o({...a,date:t.target.value}))})]}),e.jsxs("div",{className:"event-form-group",children:[e.jsx("label",{children:"Time:"}),e.jsx("input",{type:"time",className:"input-light",value:a.time,onChange:t=>p(new o({...a,time:t.target.value}))})]}),e.jsxs("div",{className:"event-form-group",children:[e.jsx("label",{children:"Location:"}),e.jsx("input",{type:"text",className:"input-light",placeholder:"Event location",value:a.location,onChange:t=>p(new o({...a,location:t.target.value}))})]}),e.jsxs("div",{className:"event-form-group",children:[e.jsx("label",{children:"Photo:"}),e.jsx("input",{type:"file",className:"input-light",onChange:t=>{t.target.files&&t.target.files[0]&&p(new o({...a,photoFile:t.target.files[0]}))}}),a.photoFile&&e.jsx("img",{src:URL.createObjectURL(a.photoFile),alt:"Preview",className:"events-dashboard-thumbnail"})]}),e.jsx("button",{className:"btn-primary",onClick:w,children:"Add Event"})]}),E&&!j&&e.jsx("button",{className:"btn-primary",onClick:P,children:"Save Changes"}),j&&e.jsx("div",{className:"loader"})]})]})}):e.jsx("div",{className:"loader-container",children:e.jsx("div",{className:"loader"})})]})}
