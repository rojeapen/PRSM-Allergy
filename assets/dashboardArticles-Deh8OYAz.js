import{c as U,j as e,r as d,n as R,q as v,w,B as y,D as k,v as I,G as M,H}from"./auth-CqMHJIpH.js";import{H as T}from"./header-Xe48X9QU.js";U.createRoot(document.getElementById("root")).render(e.jsx(d.StrictMode,{children:e.jsx(B,{})}));class c{id;title;body;mainImageFile;mainImageUrl;mainImageId;constructor(s){this.id=s.id,this.title=s.title,this.body=s.body,this.mainImageFile=s.mainImageFile,this.mainImageUrl=s.mainImageUrl,this.mainImageId=s.mainImageId}}function N({value:h,onChange:s}){const o=d.useRef(null);d.useEffect(()=>{o.current&&o.current.innerHTML!==h&&(o.current.innerHTML=h)},[]);const b=()=>{o.current&&s(o.current.innerHTML)},u=(l,n)=>{document.execCommand(l,!1,n),o.current?.focus(),b()};return e.jsxs("div",{children:[e.jsxs("div",{className:"rich-text-toolbar",children:[e.jsx("button",{type:"button",onMouseDown:l=>{l.preventDefault(),u("bold")},title:"Bold",children:e.jsx("b",{children:"B"})}),e.jsx("button",{type:"button",onMouseDown:l=>{l.preventDefault(),u("italic")},title:"Italic",children:e.jsx("i",{children:"I"})}),e.jsx("button",{type:"button",onMouseDown:l=>{l.preventDefault(),u("underline")},title:"Underline",children:e.jsx("u",{children:"U"})}),e.jsx("button",{type:"button",onMouseDown:l=>{l.preventDefault();const n=window.getSelection();if(n&&n.rangeCount>0&&n.anchorNode?.parentElement?.closest("a"))u("unlink");else{const m=prompt("Enter URL:");if(m){u("createLink",m);const g=window.getSelection();if(g&&g.anchorNode){const i=g.anchorNode.parentElement?.closest("a")||g.anchorNode.parentElement;i&&i.tagName==="A"&&(i.target="_blank",i.rel="noopener noreferrer")}b()}}},title:"Insert Link",children:"ðŸ”—"}),e.jsxs("select",{onChange:l=>{u("fontSize",l.target.value)},defaultValue:"3",title:"Font Size",children:[e.jsx("option",{value:"1",children:"Small"}),e.jsx("option",{value:"3",children:"Normal"}),e.jsx("option",{value:"5",children:"Large"}),e.jsx("option",{value:"7",children:"Huge"})]})]}),e.jsx("div",{ref:o,className:"rich-text-editor",contentEditable:!0,onInput:b})]})}function B(){const[h,s]=d.useState([]),[o,b]=d.useState(!0),[u,l]=d.useState(!1),[n,j]=d.useState(new c({title:"",body:""})),[m,g]=d.useState(null),[i,x]=d.useState(null);d.useEffect(()=>{R(()=>{}),v().then(t=>{s(t),b(!1)})},[]);const p=async()=>{const t=await v();s(t)},A=async()=>{if(!n.title.trim()||!n.body.trim())return;l(!0);const t=new Date().toISOString();let a;n.mainImageFile&&(a=await w(n.mainImageFile,`Article_${n.title}_${Date.now()}`));const r=new y({id:"",title:n.title,body:n.body,createdAt:t,updatedAt:t,mainImage:a});await k(r),await p(),j(new c({title:"",body:""})),l(!1)},C=t=>{g(t.id),x(new c({id:t.id,title:t.title,body:t.body,mainImageUrl:t.mainImage?.url,mainImageId:t.mainImage?.id}))},F=async()=>{if(!i||!m)return;l(!0);const t=new Date().toISOString(),a=h.find(L=>L.id===m);let r=a?.mainImage;i.mainImageFile?(a?.mainImage&&await I(a.mainImage),r=await w(i.mainImageFile,`Article_${i.title}_${Date.now()}`)):!i.mainImageUrl&&a?.mainImage&&(await I(a.mainImage),r=void 0);const f=new y({id:m,title:i.title,body:i.body,createdAt:a?.createdAt||t,updatedAt:t,mainImage:r});await M(m,f),await p(),g(null),x(null),l(!1)},S=async t=>{l(!0);const a=h.find(r=>r.id===t);a?.mainImage&&await I(a.mainImage),await H(t),await p(),m===t&&(g(null),x(null)),l(!1)},E=()=>{g(null),x(null)},D=(t,a=120)=>{const r=document.createElement("div");r.innerHTML=t;const f=r.textContent||r.innerText||"";return f.length>a?f.substring(0,a)+"...":f};return e.jsxs(e.Fragment,{children:[e.jsx(T,{isDashboardArticlesPage:!0}),o?e.jsx("div",{className:"loader-container",children:e.jsx("div",{className:"loader"})}):e.jsxs("section",{className:"dashboard-section light",children:[e.jsxs("div",{className:"section-title",children:[e.jsx("h1",{children:"Articles"}),e.jsx("p",{children:"Create, edit, and manage articles."})]}),e.jsxs("div",{className:"articles-dashboard-content",children:[e.jsxs("div",{className:"articles-dashboard-list",children:[h.length===0&&e.jsx("div",{style:{textAlign:"center"},children:"No articles yet."}),h.map(t=>e.jsx("div",{className:"articles-dashboard-item",children:m===t.id?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"article-form-group",children:[e.jsx("label",{children:"Title:"}),e.jsx("input",{type:"text",className:"input-light",value:i?.title||"",onChange:a=>x(new c({...i,title:a.target.value}))})]}),e.jsxs("div",{className:"article-form-group",children:[e.jsx("label",{children:"Main Image:"}),(i?.mainImageFile||i?.mainImageUrl)&&e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("img",{src:i.mainImageFile?URL.createObjectURL(i.mainImageFile):i.mainImageUrl,alt:"Preview",style:{maxWidth:"100%",maxHeight:200,borderRadius:8,objectFit:"cover"}}),e.jsx("button",{className:"btn-danger",style:{marginTop:"0.5rem",fontSize:"0.8rem",padding:"0.3rem 0.7rem"},onClick:()=>x(new c({...i,mainImageFile:void 0,mainImageUrl:void 0,mainImageId:void 0})),children:"Remove Image"})]}),e.jsx("input",{type:"file",accept:"image/*",className:"input-light",onChange:a=>{a.target.files&&a.target.files[0]&&x(new c({...i,mainImageFile:a.target.files[0]}))}})]}),e.jsxs("div",{className:"article-form-group",children:[e.jsx("label",{children:"Body:"}),e.jsx(N,{value:i?.body||"",onChange:a=>x(new c({...i,body:a}))},`edit-${t.id}`)]}),e.jsxs("div",{className:"articles-dashboard-actions",children:[e.jsx("button",{className:"btn-primary",onClick:F,children:"Save"}),e.jsx("button",{className:"btn-danger",onClick:E,children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"articles-dashboard-item-preview",children:e.jsxs("div",{className:"articles-dashboard-item-info",children:[e.jsx("h4",{children:t.title}),e.jsx("p",{style:{color:"#0A6C95",fontWeight:600},children:t.getDisplayDate()}),e.jsx("p",{children:D(t.body)})]})}),e.jsxs("div",{className:"articles-dashboard-actions",children:[e.jsx("button",{className:"btn-primary",onClick:()=>C(t),children:"Edit"}),e.jsx("button",{className:"btn-danger",onClick:()=>S(t.id),children:"Delete"})]})]})},t.id))]}),e.jsxs("div",{className:"articles-dashboard-add",children:[e.jsx("h3",{style:{margin:"0 0 1rem 0"},children:"Create New Article"}),e.jsxs("div",{className:"article-form-group",children:[e.jsx("label",{children:"Title:"}),e.jsx("input",{type:"text",className:"input-light",placeholder:"Article title",value:n.title,onChange:t=>j(new c({...n,title:t.target.value}))})]}),e.jsxs("div",{className:"article-form-group",children:[e.jsx("label",{children:"Main Image:"}),n.mainImageFile&&e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("img",{src:URL.createObjectURL(n.mainImageFile),alt:"Preview",style:{maxWidth:"100%",maxHeight:200,borderRadius:8,objectFit:"cover"}}),e.jsx("button",{className:"btn-danger",style:{marginTop:"0.5rem",fontSize:"0.8rem",padding:"0.3rem 0.7rem"},onClick:()=>j(new c({...n,mainImageFile:void 0})),children:"Remove Image"})]}),e.jsx("input",{type:"file",accept:"image/*",className:"input-light",onChange:t=>{t.target.files&&t.target.files[0]&&j(new c({...n,mainImageFile:t.target.files[0]}))}})]}),e.jsxs("div",{className:"article-form-group",children:[e.jsx("label",{children:"Body:"}),e.jsx(N,{value:n.body,onChange:t=>j(new c({...n,body:t}))},"new-article")]}),e.jsx("button",{className:"btn-primary",onClick:A,children:"Add Article"})]}),u&&e.jsx("div",{className:"loader"})]})]})]})}
